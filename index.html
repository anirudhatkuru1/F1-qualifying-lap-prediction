<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>F1 Qualifying Lap Predictor</title>
</head>
<body>

<h1>F1 Qualifying Lap Predictor</h1>

<label>Driver</label>
<select id="driver"></select>

<label>Team</label>
<select id="team"></select>

<label>Event</label>
<select id="event"></select>

<label>Qualifying Segment</label>
<select id="segment">
  <option>Q1</option>
  <option>Q2</option>
  <option selected>Q3</option>
</select>

<br><br>
<button onclick="predict()">Predict</button>

<div id="result"></div>

<script>
const API_BASE = "https://f1-qualifying-lap-prediction.onrender.com";

const driverSelect  = document.getElementById("driver");
const teamSelect    = document.getElementById("team");
const eventSelect   = document.getElementById("event");
const segmentSelect = document.getElementById("segment");
const resultDiv     = document.getElementById("result");

async function loadMetadata() {
  const res = await fetch(`${API_BASE}/metadata`);
  const data = await res.json();

  driverSelect.innerHTML = data.drivers.map(d => `<option>${d}</option>`).join("");
  teamSelect.innerHTML   = data.teams.map(t => `<option>${t}</option>`).join("");
  eventSelect.innerHTML  = data.events.map(e => `<option>${e}</option>`).join("");
}

async function predict() {
  resultDiv.innerText = "Predicting...";

  const res = await fetch(`${API_BASE}/predict`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      driver: driverSelect.value,
      team: teamSelect.value,
      event: eventSelect.value,
      quali_segment: segmentSelect.value
    })
  });

  const data = await res.json();

  if (data.error) {
    resultDiv.innerText = "Error: " + data.error;
    return;
  }

  resultDiv.innerText = `Predicted lap time: ${data.predicted_lap_time_sec} sec`;
}

loadMetadata();
</script>

</body>
</html>
